# üöÄ STRIPE PRODUCTION - –§–ò–ù–ê–õ–¨–ù–ê–Ø –ù–ê–°–¢–†–û–ô–ö–ê

**–î–∞—Ç–∞:** 29 —è–Ω–≤–∞—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** CRITICAL - –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –°–ú–ï–®–ê–ù–ù–´–• –ö–õ–Æ–ß–ï–ô  
**–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞:** Context7 Stripe –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ + –∞–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏  

---

## üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê**

–ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã **—Å–º–µ—à–∞–Ω–Ω—ã–µ live/test –∫–ª—é—á–∏** - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É–≥—Ä–æ–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!

```
‚ùå Publishable Key: pk_live_... (LIVE)
‚ùå Secret Key: sk_test_...     (TEST)
```

**–≠–¢–û –ù–ï–î–û–ü–£–°–¢–ò–ú–û –í PRODUCTION!**

---

## ‚ö° **–°–†–û–ß–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø - –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**

### **–®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –ü–†–ê–í–ò–õ–¨–ù–´–ï LIVE KEYS**

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Stripe Dashboard**: https://dashboard.stripe.com/
2. **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û**: –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –≤ **Live mode** 
   - –ù–∞–π–¥–∏—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–ª–µ–≤–∞ –≤–Ω–∏–∑—É
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –æ–Ω **–ó–ï–õ–ï–ù–´–ô** –∏ –Ω–∞–ø–∏—Å–∞–Ω–æ "Live"
3. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ**: Developers ‚Üí API keys
4. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –û–ë–ê LIVE –∫–ª—é—á–∞:**

```bash
# Publishable key (–¥–ª—è frontend)
pk_live_xxxxxxxxxxxxxxxxxxxxxxxxxx

# Secret key (–¥–ª—è backend) 
sk_live_xxxxxxxxxxxxxxxxxxxxxxxxxx
```

### **–®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ .env.local**

–ó–∞–º–µ–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ `.env.local`:

```bash
# –ù–ê–ô–î–ò–¢–ï –°–¢–†–û–ö–ò:
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_live_–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_LIVE_–ö–õ–Æ–ß_–ó–î–ï–°–¨"
STRIPE_SECRET_KEY="sk_live_–í–ê–®_–†–ï–ê–õ–¨–ù–´–ô_LIVE_–ö–õ–Æ–ß_–ó–î–ï–°–¨"

# –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –ù–ê–°–¢–û–Ø–©–ò–ï LIVE KEYS –ò–ó DASHBOARD
```

### **–®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ Live Webhook**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–±:**
```bash
node scripts/setup-stripe-webhooks.js
```

**–†—É—á–Ω–æ–π —Å–ø–æ—Å–æ–±:**
1. –í Live mode: Developers ‚Üí Webhooks ‚Üí Add endpoint
2. URL: `https://cascaisfishing.com/api/stripe-webhooks`
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤ `STRIPE_WEBHOOKS_MANUAL_SETUP.md`
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ webhook secret (whsec_...)
5. –û–±–Ω–æ–≤–∏—Ç–µ –≤ .env.local: `STRIPE_WEBHOOK_SECRET="whsec_..."`

---

## üß™ **–ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É:

```bash
node scripts/check-stripe-production.js
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Publishable Key –∑–∞–≥—Ä—É–∂–µ–Ω
‚úÖ Secret Key –∑–∞–≥—Ä—É–∂–µ–Ω  
‚úÖ Webhook Secret –∑–∞–≥—Ä—É–∂–µ–Ω
‚úÖ Publishable Key —Ñ–æ—Ä–º–∞—Ç
‚úÖ Secret Key —Ñ–æ—Ä–º–∞—Ç
‚úÖ Webhook Secret —Ñ–æ—Ä–º–∞—Ç
üöÄ LIVE MODE –ê–ö–¢–ò–í–ï–ù
–ü—Ä–æ–π–¥–µ–Ω–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: 10/10 (100%) ‚úÖ
üéâ –í–°–ï –ü–†–û–í–ï–†–ö–ò –ü–†–û–ô–î–ï–ù–´!
```

---

## üîß **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï PRODUCTION MODE**

### **1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

```bash
npm run dev
```

### **2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏:**

```bash
curl http://localhost:3001/test-monetization
```

### **3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π checkout:**

```bash
curl -X POST http://localhost:3001/api/create-checkout-session \
  -H "Content-Type: application/json" \
  -d '{
    "priceId": "price_1S0sGVFwX7vboUlLvRXgNxmr",
    "mode": "subscription",
    "successUrl": "http://localhost:3001/success",
    "cancelUrl": "http://localhost:3001/pricing"
  }'
```

### **4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ webhook:**

```bash
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ —á–µ—Ä–µ–∑ Stripe CLI
stripe trigger payment_intent.succeeded

# –ò–ª–∏ —á–µ—Ä–µ–∑ Dashboard: Webhooks ‚Üí Send test webhook
```

---

## üìä **–ò–ù–î–ò–ö–ê–¢–û–†–´ –£–°–ü–ï–®–ù–û–ô –ù–ê–°–¢–†–û–ô–ö–ò**

### **‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç:**
- –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã (100%)
- LIVE MODE –ê–ö–¢–ò–í–ï–ù
- –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

### **‚úÖ –í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:**
- Checkout session —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- Redirects —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Webhook —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è

### **‚úÖ –í Stripe Dashboard:**
- Live mode –∞–∫—Ç–∏–≤–µ–Ω
- Webhook endpoint –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Enabled"
- Recent deliveries = 200 OK

### **‚úÖ –í –ª–æ–≥–∞—Ö:**
```bash
‚úÖ Webhook signature verified
‚úÖ Successfully processed event  
üí∞ Processing successful payment
‚úÖ Payment updated in database
```

---

## ‚ö†Ô∏è **–í–ê–ñ–ù–´–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø PRODUCTION**

### **üî¥ LIVE MODE = –†–ï–ê–õ–¨–ù–´–ï –î–ï–ù–¨–ì–ò!**

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤ Live mode:

- ‚ùó **–í–°–ï –ü–õ–ê–¢–ï–ñ–ò –°–¢–ê–ù–û–í–Ø–¢–°–Ø –†–ï–ê–õ–¨–ù–´–ú–ò**
- ‚ùó **–¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ù–ï –†–ê–ë–û–¢–ê–Æ–¢**
- ‚ùó **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –†–ï–ê–õ–¨–ù–´–ï –∫–∞—Ä—Ç—ã**
- ‚ùó **Stripe –±–µ—Ä–µ—Ç –∫–æ–º–∏—Å—Å–∏—é —Å –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**

### **üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π:**

- üö® **–ù–ò–ö–û–ì–î–ê –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ .env.local –≤ Git**
- üö® **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ live keys**
- üö® **–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ API –∫–ª—é—á–∏**
- üö® **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**

---

## üéØ **PRODUCTION DEPLOYMENT CHECKLIST**

### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**

- [ ] ‚úÖ –û–±–∞ Stripe –∫–ª—é—á–∞ LIVE (pk_live_ + sk_live_)
- [ ] ‚úÖ Webhook secret –ø–æ–ª—É—á–µ–Ω –∏–∑ Live mode
- [ ] ‚úÖ 100% –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–æ–π–¥–µ–Ω–æ –≤ —Å–∫—Ä–∏–ø—Ç–µ
- [ ] ‚úÖ –î–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å HTTPS
- [ ] ‚úÖ Database –≥–æ—Ç–æ–≤–∞ –∫ production
- [ ] ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ alerting –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:**

- [ ] üìä Checkout flow —Ä–∞–±–æ—Ç–∞–µ—Ç end-to-end
- [ ] üí≥ Subscription —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] üîî Webhook —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- [ ] üìß Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è
- [ ] üö® Error handling —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üöÄ **–ì–û–¢–û–í–ù–û–°–¢–¨ –ö PRODUCTION**

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:

1. **100% –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** –≤ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ
2. **LIVE mode –∞–∫—Ç–∏–≤–µ–Ω** –≤ Stripe
3. **–í—Å–µ webhooks –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã** –∏ —Ä–∞–±–æ—Ç–∞—é—Ç  
4. **End-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø—Ä–æ–π–¥–µ–Ω–æ
5. **Monitoring** –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### **üéâ –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!**

**Cascais Fishing –≥–æ—Ç–æ–≤–∞ –∫ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–°–∏—Å—Ç–µ–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º:
- ‚úÖ Context7 Stripe Node.js —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- ‚úÖ t3dotgg production patterns
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- ‚úÖ Scalable –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ú–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏! üí∞**

---

## üìû **–ü–û–î–î–ï–†–ñ–ö–ê –ò TROUBLESHOOTING**

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫—Ä–∏–ø—Ç:** `node scripts/check-stripe-production.js`
2. **Stripe Dashboard:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ mode –∏ webhook delivery
3. **–õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É webhook
4. **Network:** –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ endpoint

**–ü–æ–º–Ω–∏—Ç–µ: –≤ Live mode –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª—å–Ω—ã–µ!**
